grammar Structural;

@lexer::header{
    package org.cidarlab.phoenix.core.grammars.structural;
}
@parser::header{
    package org.cidarlab.phoenix.core.grammars.structural;
}

root
    :    module
    ;

module
    : (forward_tu|reverse_tu)+
    ;  
forward_tu
    : forward_promoter (wildcard_fp)* (forward_rbs forward_cds)+ (wildcard_fc)* forward_terminator
    ;

reverse_tu
    : reverse_terminator (wildcard_rc)* (reverse_cds reverse_rbs)+ (wildcard_rp)* reverse_promoter 
    ;  

wildcard_fp
    : (reverse_promoter|reverse_rbs|reverse_cds|reverse_terminator|forward_cds)+
    ;
wildcard_fc
    : (reverse_promoter|reverse_rbs|reverse_cds|reverse_terminator|forward_promoter)+
    ;
wildcard_rp
    : (forward_promoter|forward_rbs|forward_cds|forward_terminator|reverse_cds)+
    ;
wildcard_rc
    : (forward_promoter|forward_rbs|forward_cds|forward_terminator|reverse_promoter)+
    ;

reverse_promoter
    : '<p'+
    ;
forward_promoter
    : 'p'+
    ;
reverse_rbs
    : '<r'
    ;
forward_rbs
    : 'r'
    ;
reverse_cds
    : '<c'+
    | '<f'+
    ;
forward_cds
    : 'c'+
    | 'f'+
    ;
reverse_terminator
    : '<t'
    ;
forward_terminator
    : 't'
    ;

WS : [ \t\r\n]+ -> skip ;